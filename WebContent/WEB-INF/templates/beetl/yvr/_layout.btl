<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <%DIRECTIVE DYNAMIC;%>
  <!-- meta -->
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- see http://smerity.com/articles/2013/where_did_all_the_http_referrers_go.html -->
  <meta name="referrer" content="always">
  <meta property="qc:admins" content="345615513542636" />

  <link title="RSS" type="application/rss+xml" rel="alternate" href="${ctxPath}/yvr/rss"/>

  <link rel="icon" href="${ctxPath}/rs/logo.png" type="image/x-icon"/>
  <link rel="stylesheet" type="text/css" href="${ctxPath}/rs/logo/logo.css"/>

  <!-- style -->
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/libs/bootstrap/css/bootstrap.css"></link>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/stylesheets/common.css"></link>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/stylesheets/style.css"></link>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/stylesheets/responsive.css"></link>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/stylesheets/jquery.atwho.css"></link>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/layer2/layer/skin/layer.css"></link>
<style>
    @font-face {
	font-family: 'icomoon';
	src:url('${ctxPath}/rs/libs/editor/fonts/icomoon.eot');
	src:url('${ctxPath}/rs/libs/editor/fonts/icomoon.eot?#iefix') format('embedded-opentype'),
		url('${ctxPath}/rs/libs/editor/fonts/icomoon.woff') format('woff'),
		url('${ctxPath}/rs/libs/editor/fonts/icomoon.ttf') format('truetype'),
		url('${ctxPath}/rs/libs/editor/fonts/icomoon.svg#icomoon') format('svg');
	font-weight: normal;
	font-style: normal;
}
</style>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/libs/editor/editor.css"></link>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/libs/webuploader/webuploader.css"></link>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/libs/code-prettify/prettify.css"></link>
<style>
@font-face {
  font-family: 'FontAwesome';
  src: url('${ctxPath}/rs/libs/font-awesome/fonts/fontawesome-webfont.eot?v=4.2.0');
  src: url('${ctxPath}/rs/libs/font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.2.0') format('embedded-opentype'), url('${ctxPath}/rs/libs/font-awesome/fonts/fontawesome-webfont.woff?v=4.2.0') format('woff'), url('${ctxPath}/rs/libs/font-awesome/fonts/fontawesome-webfont.ttf?v=4.2.0') format('truetype'), url('${ctxPath}/rs/libs/font-awesome/fonts/fontawesome-webfont.svg?v=4.2.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
</style>
<link rel="stylesheet" type="text/css" href="${ctxPath}/rs/libs/font-awesome/css/font-awesome.css"></link>

  <!-- scripts -->
<script src="${ctxPath}/rs/libs/jquery-2.1.4.min.js"></script>
<script src="${ctxPath}/rs/libs/lodash.compat.js"></script>
<script src="${ctxPath}/rs/libs/jquery-ujs.js"></script>
<script src="${ctxPath}/rs/libs/bootstrap/js/bootstrap.js"></script>
<script src="${ctxPath}/rs/libs/jquery.caret.js"></script>
<script src="${ctxPath}/rs/libs/jquery.atwho.js"></script>
<script src="${ctxPath}/rs/libs/markdownit.js"></script>
<script src="${ctxPath}/rs/libs/code-prettify/prettify.js"></script>
<script src="${ctxPath}/rs/libs/qrcode.js"></script>
<script src="${ctxPath}/rs/javascripts/main.js"></script>
<script src="${ctxPath}/rs/javascripts/responsive.js"></script>
<script src="${ctxPath}/rs/layer2/layer/layer.js"></script>

  <% if (null != obj.topic!) { %>
  <title>${obj.topic.title, escape} - Nutz社区</title>
  <% } else if (null != title!) {%>
  <title>${title, escape} - Nutz社区</title>
  <% } else { %>
  <title>Nutz社区</title>
  <% } %>
  <meta name="Keywords" content="Nutz,Nutz是什么,Nutz下载,Nutz论坛,Nutz汉化,,Java,跨平台,Web框架,J2EE框架"/>  <meta name="Description" content="首先，它是开源的，商用也是完全免费的。详尽的文档，众多线上项目 不吹嘘概念,代码严谨可靠，近千个testcase,坚如磐石。您使用的nutz.jar,也是各位提交者在各种生产环境上使用的 nutz.jar ^_^ 一个 jar 包就包含了 Mvc,Ioc,Dao,Aop，不强制依赖第三方 jar。小巧的Lang工具箱和EL表达式引擎,满足各种小需求。内置Json序列..."/>
  <meta content="_csrf" name="csrf-param">
  <meta content="${obj._csrf!}" name="csrf-token">
</head>
<body>
<!-- navbar -->
<div class='navbar'>
  <div class='navbar-inner'>
    <div class='container'>
      <a class='brand' href='${ctxPath}/yvr/list'>
        <div class="nutz-logo-bar">
    		<div class="nutz-logo">
        		<img src="${ctxPath}/rs/logo/logo.png" alt=""/>
        		<div class="logo-tail"></div>
    		</div>
    		<div class="nutz-txt">Nutz</div>
		</div>
      </a>

      <form id='search_form' class='navbar-search' action="${ctxPath}/yvr/search">
        <input type='text' id='q' name='q' class='search-query span3' value=''/>
      </form>
      <ul class='nav pull-right'>
        <li><a href='${ctxPath}/yvr/'>首页</a></li>
        <% if (null != obj.current_user!){ %>
        <li>
        </li>
        <% } %>
        <li><a href='http://nutzbook.wendal.net' target="_blank">新手入门</a></li>
        
        <% if ( null != obj.current_user!) { %>
        <li><a href='${ctxPath}/yvr/add' rel="nofollow">发新贴</a></li>
        <li><a href='#'>${obj.current_user.nickname!, escape}</a></li>
        <li><a href='${ctxPath}/yvr/u/logout' data-method="post" rel="nofollow">退出</a></li>
        <% } else { %>
        <li><a href='#' onclick="f_signup();">注册</a></li>
        <li><a href='#' onclick="f_signin();">登录</a></li>
        <% } %>
		<li><a href='#' onclick="cs_qrcode();">跨屏二维码</a></li>
      </ul>
      <a class="btn btn-navbar" id="responsive-sidebar-trigger">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
    </div>
  </div>
</div>
<div id='main'>
  ${layoutContent}
</div>
<div id='backtotop'>回到顶部</div>
<div id='footer'>
  <div id='footer_main'>
    <div class="links">
      <a class='dark' href='${ctxPath}/yvr/rss'>RSS</a>
      |
      <a class='dark' href='https://github.com/wendal/nutz-book-project'>源码地址</a>
      | Power By 
      <a class='dark' href='https://github.com/nutzam/nutz'>Nutz</a>
      ,
      <a class='dark' href='https://github.com/javamonkey/beetl2.0'>Beetl</a>
      等优秀的开源库.
      <a class="dark" href='https://cnodejs.org'>页面模板源自cnodejs</a>
      <li class="footer-links"><a title="查看备案信息" target="_blank" href="http://www.miibeian.gov.cn">苏ICP备 10226088号-17</a></li>
    </div>

  </div>
</div>
<div id="sidebar-mask"></div>
<div id="signup_div" style="display: none">
	<form id='signup_form'>
	<div class="input-group">
  		<span class="input-group-addon" id="basic-addon1">用户名</span>
  		<input name="username" type="text" class="form-control" placeholder="仅小写英文字母和数字,4到10位" aria-describedby="basic-addon1">
	</div>
	<div class="input-group">
  		<span class="input-group-addon" id="basic-addon1">密 码</span>
  		<input name="password" type="password" class="form-control" placeholder="必须包含大小写字母,数字,特殊符号" aria-describedby="basic-addon1">
	</div>
	<div class="input-group">
  		<span class="input-group-addon" id="basic-addon1">邮箱</span>
  		<input name="email" type="email" class="form-control" placeholder="用于发送验证邮件" aria-describedby="basic-addon1">
	</div>
	<button type="button" onclick="do_signup();" class="btn btn-primary">注册</button>
	<a href="${ctxPath}/yvr/u/oauth/github">推荐通过github登陆</a>
	</form>
</div>
</form>
</div>

<div id="signin_div" style="display: none">
	<form id='signin_form'>
	<div class="input-group">
  		<span class="input-group-addon" id="basic-addon1">用户名</span>
  		<input name="username" type="text" class="form-control" placeholder="Username" aria-describedby="basic-addon1">
	</div>
	<div class="input-group">
  		<span class="input-group-addon" id="basic-addon1">密 码</span>
  		<input name="password" type="password" class="form-control" placeholder="Password" aria-describedby="basic-addon1">
	</div>
	<div class="input-group">
  		<span class="input-group-addon" id="basic-addon1">验证码</span>
  		<input name="captcha" type="text" class="form-control" placeholder="不区分大小写" aria-describedby="basic-addon1">
	</div>
	<img id="captcha_img" onclick="next_captcha();return false;"/>
	<button type="button" onclick="do_signin();" class="btn btn-primary">登陆</button>
	<a href="${ctxPath}/yvr/u/oauth/github">推荐通过github登陆</a>
	</form>
</div>
</form>
</div>

<script>
function cs_qrcode() {
	setTimeout(function() {
		var tmp = "<img src='${ctxPath}/cs/qr?url=" + encodeURIComponent(window.location.href) + "'>";
    	layer.open({"title":"跨屏二维码有效期2分钟", shadeClose : true, "type":1, content:tmp, area : ['256px', '291px']}); // 256+35 = 291
	}, 300);
};
function f_signup() {
	setTimeout(function() {
    	layer.open({"title":"一步注册", shadeClose : true, "type":1, content : $("#signup_div"), area : ['500px', '500px']});
	}, 300);
};
function f_signin() {
next_captcha();
setTimeout(function() {
		layer.open({"title":"登陆", shadeClose : true, "type":1, content : $("#signin_div"), area : ['500px', '500x']});
	}, 300);
};

function do_signup() {
	$.ajax({
		url : "${ctxPath}/yvr/u/signup",
		method : "POST",
		data : $("#signup_form").serialize(),
		dataType : "json",
		success : function(re) {
			if (console)
				console.log(re);
			layer.alert(re.msg || re.data);
		}
	});
	return false;
};

function do_signin() {
	$.ajax({
		url : "${ctxPath}/user/login",
		method : "POST",
		data : $("#signin_form").serialize(),
		dataType : "json",
		success : function(re) {
			if (console)
				console.log(re);
			if (re.ok) {
				window.location.reload();
			} else {
				layer.alert(re.msg);
			}
		},
		error : function(jqXHR, exception) {
			if (jqXHR.status == 404) {
				// 如果已经登陆过,就会404,蛋疼的shiro
				window.location.reload();
			}
		}
	});
	return false;
}

function next_captcha() {
	$("#captcha_img").attr("src", "${ctxPath}/captcha/next?w=120&h=48&_=" + new Date().getTime());
}
</script>
<% if (null != conf["topic_seo.cnzz"]) {%>
<script src="//s95.cnzz.com/z_stat.php?id=${conf["topic_seo.cnzz"]}&web_id=${conf["topic_seo.cnzz"]}" language="JavaScript"></script>
<% } %>
<% if (null != conf["topic_seo.tongji"]) { %>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?${conf["topic_seo.tongji"]}";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<% } %>
</body>
</html>